import{h as U,M as x,o as u,c as m,d as f,t as L,O as q,s as B,g as T,r as i,a as c,w as o,m as y,F as w,j as l,i as g,k as S,D as P,Q as D}from"./vendor-9b0cf635.js";import{_ as b,b as R,e as N,c as z}from"./index-abfa6c99.js";import{M as j}from"./MeetupInfo-3c879960.js";import{U as E}from"./UiButton-e852b53f.js";import{u as k}from"./useApi-f4bc375e.js";import{d as F,a as O,l as H,b as $}from"./meetupsApi-100c656f.js";const C={name:"MeetupCover",props:{title:{type:String},image:{type:String}},setup(e){return{backgroundImage:U(()=>e.image?`url('${e.image}')`:"var(--default-cover)")}}},A=()=>{x(e=>({"50a3cbe8":e.backgroundImage}))},V=C.setup;C.setup=V?(e,s)=>(A(),V(e,s)):A;const Q=C,G={class:"meetup-cover"},J={class:"meetup-cover__title"};function K(e,s,t,a,p,n){return u(),m("div",G,[f("h1",J,L(t.title),1)])}const W=b(Q,[["render",K],["__scopeId","data-v-6b6225ae"],["__file","MeetupCover.vue"]]);const X={name:"MeetupView",components:{UiButton:E,MeetupCover:W,MeetupInfo:j,UiContainer:R},props:{meetup:{type:Object,required:!0}},setup(e){const s=q(),{isAuthenticated:t}=B(N()),{isLoading:a,request:p}=k(F,{showProgress:!0,successToast:"Митап удалён",errorToast:!0}),{isLoading:n,request:r}=k(O,{showProgress:!0,successToast:"Сохранено",errorToast:!0}),{isLoading:v,request:_}=k(H,{showProgress:!0,successToast:"Сохранено",errorToast:!0}),d=T(e.meetup.attending),h=U(()=>n.value||v.value);return{isAuthenticated:t,deleteIsLoading:a,handleDeleteMeetup:async()=>{confirm("Удалить митап?")&&(await p(e.meetup.id)).success&&s.push({name:"meetups"})},handleAttendToggle:async()=>{if(d.value){const{success:M}=await _(e.meetup.id);M&&(d.value=!1)}else{const{success:M}=await r(e.meetup.id);M&&(d.value=!0)}},toggleAttendIsLoading:h,attending:d}}},Y={class:"meetup"},Z={class:"meetup__content"},ee={class:"meetup__aside"},te={key:0,class:"meetup__aside-buttons"};function ae(e,s,t,a,p,n){const r=i("MeetupCover"),v=i("MeetupInfo"),_=i("UiButton"),d=i("UiContainer");return u(),m("div",null,[c(r,{title:t.meetup.title,image:t.meetup.image},null,8,["title","image"]),c(d,null,{default:o(()=>[f("div",Y,[f("div",Z,[y(e.$slots,"default",{},void 0,!0)]),f("div",ee,[c(v,{organizer:t.meetup.organizer,place:t.meetup.place,date:t.meetup.date},null,8,["organizer","place","date"]),a.isAuthenticated?(u(),m("div",te,[t.meetup.organizing?(u(),m(w,{key:0},[c(_,{tag:"RouterLink",variant:"primary",to:{name:"meetup-edit",params:{meetupId:t.meetup.id}},class:"meetup__aside-button"},{default:o(()=>[l(" Редактировать ")]),_:1},8,["to"]),c(_,{variant:"danger",class:"meetup__aside-button",disabled:a.deleteIsLoading,onClick:a.handleDeleteMeetup},{default:o(()=>[l("Удалить")]),_:1},8,["disabled","onClick"])],64)):(u(),m(w,{key:1},[a.attending?(u(),g(_,{key:0,variant:"secondary",disabled:a.toggleAttendIsLoading,class:"meetup__aside-button",onClick:a.handleAttendToggle},{default:o(()=>[l("Отменить участие")]),_:1},8,["disabled","onClick"])):(u(),g(_,{key:1,variant:"primary",disabled:a.toggleAttendIsLoading,class:"meetup__aside-button",onClick:a.handleAttendToggle},{default:o(()=>[l(" Участвовать ")]),_:1},8,["disabled","onClick"]))],64))])):S("",!0)])])]),_:3})])}const se=b(X,[["render",ae],["__scopeId","data-v-e3233849"],["__file","MeetupView.vue"]]);const ne={name:"UiTabs"},oe={class:"tabs"},ue={class:"tabs__nav",role:"tablist"},ie={class:"tabs__content"};function ce(e,s,t,a,p,n){return u(),m("div",oe,[f("div",ue,[y(e.$slots,"tabs",{},void 0,!0)]),f("div",ie,[y(e.$slots,"default",{},void 0,!0)])])}const re=b(ne,[["render",ce],["__scopeId","data-v-02e4e06c"],["__file","UiTabs.vue"]]);const _e={name:"UiTab",props:{to:{default:"#"}}};function de(e,s,t,a,p,n){const r=i("RouterLink");return u(),g(r,{to:t.to,class:"tabs__tab",role:"tab","exact-active-class":"tabs__tab_active"},{default:o(()=>[y(e.$slots,"default",{},void 0,!0)]),_:3},8,["to"])}const le=b(_e,[["render",de],["__scopeId","data-v-9c6bf875"],["__file","UiTab.vue"]]),pe={name:"PageMeetup",components:{UiTab:le,UiTabs:re,MeetupView:se,UiAlert:z,UiContainer:R},async beforeRouteEnter(e){const s=await $(+e.params.meetupId);return s.success?t=>{t.setMeetup(s.data)}:{name:"meetups"}},props:{meetupId:{type:Number,required:!0}},setup(e){const s=T(null),t=T(null);return P({title:U(()=>{var n;return((n=s.value)==null?void 0:n.title)??"Митап"})}),D(()=>e.meetupId,async()=>{s.value=null,t.value=null;const n=await $(e.meetupId);n.success?s.value=n.data:t.value=n.error.message}),{meetup:s,error:t,setMeetup:n=>s.value=n}}},me={class:"page-meetup"};function fe(e,s,t,a,p,n){const r=i("UiTab"),v=i("RouterView"),_=i("UiTabs"),d=i("MeetupView"),h=i("UiAlert"),I=i("UiContainer");return u(),m("div",me,[a.meetup?(u(),g(d,{key:0,meetup:a.meetup},{default:o(()=>[c(_,null,{tabs:o(()=>[c(r,{to:{name:"meetup.description",params:{meetupId:t.meetupId}}},{default:o(()=>[l("Описание")]),_:1},8,["to"]),c(r,{to:{name:"meetup.agenda",params:{meetupId:t.meetupId}}},{default:o(()=>[l("Программа")]),_:1},8,["to"])]),default:o(()=>[c(v,{meetup:a.meetup},null,8,["meetup"])]),_:1})]),_:1},8,["meetup"])):a.error?(u(),g(I,{key:1},{default:o(()=>[c(h,null,{default:o(()=>[l(L(a.error),1)]),_:1})]),_:1})):(u(),g(I,{key:2},{default:o(()=>[c(h,null,{default:o(()=>[l("Загрузка...")]),_:1})]),_:1}))])}const ke=b(pe,[["render",fe],["__file","PageMeetup.vue"]]);export{ke as default};
